数据可视化高级作业

### 题目一

绘制如下子视图

![](./homework3.png)

要求：

* 设置中文字体并设置字体大小
* 分别计算每个城市年份、季度、月份、小时的PM2.5数据
* 会用到分组求平均值操作
* 进行数据重塑
* 根据需要调整行索引或者列索引
* 创建子视图2行2列
* 向子视图分别绘制年份、季度、月份、小时的各城市PM2.5走势数据
* 根据需要设置坐标轴标签（比如月份、小时）



答案：

```Python
%%time
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
plt.rcParams['font.family'] = 'STKaiti'
plt.rcParams['font.size'] = 18
df = pd.read_excel('./data/PM2.5.xlsx')

fig,axes = plt.subplots(2,2,figsize = (16,12)) # 添加子视图
df2 = df.groupby(by = ['城市','年份'])[['PM2.5']].mean().round(2)
# 数据重塑
df2 = df2.unstack(level = 0)
df2.columns = df2.columns.droplevel(0)
df2 = df2[['北京','上海','广州','沈阳','成都']]
df2.plot(ax = axes[0,0])

df3 = df.groupby(by = ['城市','季节'])[['PM2.5']].mean().round(2)
# 数据重塑
df3= df3.unstack(level = 0)
df3 = df3.loc[list('春夏秋冬')]
df3.columns = df3.columns.droplevel(0)
df3 = df3[['北京','上海','广州','沈阳','成都']]
df3.plot(ax = axes[0,1])

df4 = df.groupby(by = ['城市','月份'])[['PM2.5']].mean().round(2)
# 数据重塑
df4= df4.unstack(level = 0)
df4.columns = df4.columns.droplevel(0)
df4 = df4[['北京','上海','广州','沈阳','成都']]
months = ['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月']
ax = df4.plot(ax = axes[1,0])
ax.set_xticks(np.arange(1,13))
ax.set_xticklabels(months,rotation = 60)

df5 = df.groupby(by = ['城市','小时'])[['PM2.5']].mean().round(2)
# 数据重塑
df5= df5.unstack(level = 0)
df5.columns = df5.columns.droplevel(0)
df5 = df5[['北京','上海','广州','沈阳','成都']]
ax = df5.plot(ax = axes[1,1])
_ = ax.set_xticks(np.arange(0,24))

plt.savefig('./homework3.png')
```

